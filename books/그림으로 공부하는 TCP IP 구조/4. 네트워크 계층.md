- 네트워크 계층은 이더넷이나 무선 LAN에서 만들어진 네트워크를 함께 연결해, 다른 네트워크에 있는 단말과 연결성을 확보하는 계층이다.
- 데이터링크 계층은 가은 네트워크 안에 존재하는 단말들의 연결까지만 담당한다.

## IPv4
### IPv4의 패킷 포맷
- IP에 의해 캡슐화되는 패킷을 **IP 패킷**이라고 한다. IP 패킷은 **IP 헤더**, **IP 페이로드**로 나뉜다.
- 패킷 교환 방식에서는 데이터를 나눠서 송신한다. IP에서 데이터를 작게 나누는 처리를 **IP 프래그멘테이션**이라고 한다. **식별자**, **플래그**, **프래그먼트 오프셋**에는 IP 프래그멘테이션에 관한 정보가 저장되어 있다.
- TTL(Time To Live): IP 패킷의 수명은 **경유하는 라우터 수**를 의미한다.
- IPv4 주소는 4바이트 식별 ID이다. 기기 종류나 용도에 따라 여러 IP 주소를 가질 수도 있다.
### IPv4 주소와 서브넷 마스크
- IPv4 주소는 4바이트로 구성되어 있으며, 1바이트씩 점으로 구분해 10진수로 표현한다. 점으로 구분한 그룹은 **옥텟**(octet)이라 부른다.
#### 서브넷 마스크는 네트워크와 호스트의 구분점
- IPv4 주소는 **서브넷 마스크**라는 또 다른 32비트 값과 세트로 사용한다.
- IPv4 주소는 **네트워크 부분**과 **호스트 부분** 2개로 구성되어 있다.
- **네트워크 부분**은 '==어떤 네트워크에 있는가=='를 나타내고, **호스트 부분**은 '==어떤 단말인가=='를 나타낸다.
- 서브넷 마스크에서 1은 네트워크 부분을, 0은 호스트 부분을 의미한다.
- CIDR 표기는 IPv4 주소 뒤에 '/'와 서브넷 마스크 '1'의 비트 수를 표기한다
	- ==192.168.100.1==라는 주소에 ==255.255.255.0==이라는 서브넷 마스크가 설정된 경우 CIDR 표기에서는 ==192.168.100.1/24==가 된다
### 다양한 IPv4 주소
#### 사용 용도에 따른 분류
- 사용 용도에 따라 클래스 A에서 클래스 E까지 3개 주소 그룹으로 분류할 수 있다.
- 이 중, 일반적으로 사용하는 건 A~C이다.
- 주로 클래스 분류는 32비트의 앞 1~4비트로 결정된다. 클래스 A의 앞 1비트는 '0'이다.
#### 사용 장소에 따른 분류
- IPv4 주소는 사용하는 장소에 따라 **글로벌 IPv4 주소**, **프라이빗 IPv4 주소**의 2종류로 분류할 수 있다.
- 프라이빗 IPv4 주소는 조직안에서 자유롭게 할당할 수 있다. 인터넷에 접속할 때는 프라이빗 IPv4 주소를 글로벌 IPv4 주소로 변환해야 한다. IP 주소를 변환하는 기능을 NAT(Network Address Translation)이라고 한다.
#### 예외 주소
##### 네트워크 주소
- 호스트 부분의 비트가 모두 '0'인 IP 주소로, 네트워크 자체를 나타낸다.
- '0.0.0.0/0'은 기본 경로 주소로, 모든 네트워크를 나타낸다.
##### 브로드캐스트 주소
- 호스트 부분의 비트가 모두 '1'인 IP 주소로, 같은 네트워크에 존재하는 모든 단말을 나타낸다.
- '255.255.255.255/32'는 리미티드 브로드 캐스트 주소가 된다. 같은 네트워크에 있는 모든 단말에 패킷을 송신한다.
##### 루프백 주소
- 자기 자신을 나타내는 IPv4 주소
- 루프백 주소는 1옥텟이 '127'인 IPv4 주소다. 1옥텟이 '127'이면 어떤 주소를 사용해도 상관없지만, 통상 '127.0.0.1/8'을 사용한다.
<br>
## IPv6
### IPv6 주소
- IPv4 주소가 32비트인 것에 비해, IPv6 주소는 128bit이다.
- IPv6주소는 128비트를 16비트씩 ':'(콜론)으로 구분해 16진수로 표현한다.
### 서브넷 프리픽스와 인터페이스 ID
- 서브넷 프리피스는 IPv4의 네트워크 부분에 해당
- 인터페이스 ID는 IPv4의 호스트 부분에 해당
- IPv4와 마찬가지로 '/'(슬래시) 이후의 숫자로 어디까지가 서브넷 프리픽스인지 나타낸다.

## IP 라우팅
- **라우터**와 **L3 스위치**가 다른 네트워크를 연결하고, IP 패킷을 전송한다.
### 라우팅
- **수신지 네트워크** 정보, **네트워크 홉** 정보를 관리해 IP 패킷의 전송 대상지를 바꾼다.
- **네트워크 홉**: IP 패킷을 전송할 근접 기기의 IP 주소 (수신지로 가려면 어느 라우터로 보내야할지)
- 수신지 네트워크와 네트워크 홉을 관리하는 표를 **라우팅 테이블**이라고 한다.
### 라우팅 테이블
- 라우팅 테이블을 만드는 방법은 크게 **정적 라우팅**과 **동적 라우팅** 2가지로 나눌 수 있다.
#### 정적 라우팅
- 수동으로 라우팅 테이블을 만드는 방법
- 소규모 네트워크에 적합
#### 동적 라우팅
- 근접한 라우터끼리 자신이 가진 경로 정보를 교환해 자동으로 라우팅 테이블을 만드는 방법
- **라우팅 프로토콜**: 경로 정보를 교환하기 위한 프로토콜
### 라우팅 프로토콜
- 제어 범위에 따라 **IGP**, **EGP**로 나뉨
- **AS** 내부를 제어하는 프로토콜이 **IGP**, AS와 AS 사이를 제어하는 프로토콜이 **EGP**
#### IPG의 핵심 (라우팅 알고리즘, 메트릭)
- 다양한 IPG가 있지만 현재 주로 사용되는 건 **RIP**, **OSPF**, **EIGRP** 중 하나
##### 라우팅 알고리즘
- **디스턴스 벡터 타입**: 거리와 방향에 기반해 경로를 계산하는 라우팅 프로토콜
- **링크 스테이트 타입**: 링크 상태에 기반해 최적 경로를 계산하는 라우팅 프로토콜
##### 메트릭
- 수신지 네트워크까지의 거리
#### EGP의 핵심 (AS 번호, 라우팅 알고리즘, 최선경로 선택 알고리즘)
- 일반적으로 **BPG**를 사용한다.
##### AS 번호
- AS를 식별하는 번호
##### 라우팅 알고리즘
- **경로 벡터 타입**: 경로와 방향에 기반해 경로를 계산
#####  최선경로 선택 알고리즘

## IP 주소 할당 방법
### 정적 할당
### 동적 할당

- **DHCP**를 필두로 몇 가지 프로토콜을 구사해 자동화한다.
#### IPv4 동적할당
- IPv4에서는 **DHCPv4**를 사용
- **DHCPv4**에서는 브로드캐스트와 유니캐스트 양쪽을 사용하면서 UDP로 교환
#### IPv6 동적할당
- IPv6의 동적할당 방법으로는 **SLAAC**와 **DHCPv6** 2가지가 있다.
##### SLAAC
##### DHCPv6

## NAP
- IP 주소를 변환하는 기술
- 변환 전후의 IP 주소나 포트번호를 NAT 테이블이라는 메모리상의 테이블에서 관리
### 정적 NAT
- 내부와 외부의 IP 주소를 1:1로 묶어서 변환
### NAPT
- 내부와 외부의 IP 주소를 n:1로 연결해서 변환
- 

## ICMP
- IP 레벨의 통신을 확인하거나 다양한 에러를 알리는 등 IP 네트워크에서 중요한 역할을 담당


## IPsec
- 네트워크 계층에서 IP 패킷의 캡슐화나 인증, 암호화하고 인터넷상에 가상의 전용선을 만드는 가상화 기술